(function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):e.TeleportVR=i()})(this,function(){"use strict";var e=function(e,i){var t=new THREE.Group;t.add(i),e.add(t);var o=new THREE.Group;t.add(o);var n=new THREE.QuadraticBezierCurve3(new THREE.Vector3(0,0,0),new THREE.Vector3(1,3,-1),new THREE.Vector3(2,0,-2)),r=10,a=new THREE.Mesh(new THREE.CylinderGeometry(1,1,.01,8),new THREE.MeshBasicMaterial({color:17663,wireframe:!0}));a.name="helper",o.add(a),a=new THREE.Mesh(new THREE.CubeGeometry(.1,.1,2),new THREE.MeshBasicMaterial({color:17663,wireframe:!0})),a.translateZ(-1),a.name="helperDirection",o.add(a),o.visible=!1;var s=new THREE.TubeBufferGeometry(n,9,.1,3,!1),c=new THREE.Mesh(s,new THREE.MeshBasicMaterial({color:16711680,wireframe:!0}));c.visible=!1,t.add(c);var E=new THREE.Raycaster,d=new THREE.Vector3(0,-1,0);E.ray.direction.copy(d);var p=!1,u={};return{add:function(e){t.add(e)},target:o,curve:c,removeTargetHelpers:function(i){o.remove(e.getObjectByName("helper")),o.remove(e.getObjectByName("helperDirection"))},setMaxDistance:function(e){r=e},teleport:function(e){p=!1,o.visible=!1,c.visible=!1,o.getWorldPosition(t.position),o.getWorldQuaternion(t.quaternion)},update:function(e){if(p){var i=new THREE.Vector3(0,0,-1);if(i.applyQuaternion(u.quaternion),o.position.set(i.x*r,0,i.z*r),e){o.getWorldPosition(E.ray.origin),E.ray.origin.y+=10;var a=E.intersectObjects(e);a.length>0&&(o.position.y=a[0].point.y-t.position.y)}n.v0.copy(o.position),n.v2.copy(u.position),n.v2.add((new THREE.Vector3).setFromMatrixPosition(u.standingMatrix));var s=new THREE.Object3D;s.position.copy(n.v2),s.quaternion.copy(u.quaternion),s.translateZ(-3),n.v1.copy(s.position),c.geometry.copy(new THREE.TubeBufferGeometry(n,9,.05,3,!1)),c.geometry.needsUpdate=!0}},show:function(e){u=e,p=!0,o.rotation.y=0,o.visible=!0,c.visible=!0},hide:function(){p=!1,o.visible=!1,c.visible=!1}}};return e});